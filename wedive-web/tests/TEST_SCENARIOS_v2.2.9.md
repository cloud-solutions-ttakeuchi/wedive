# Test Scenarios v2.2.9 - DB Schema Redesign

## 1. ID命名規則の検証
- [ ] シードデータのインポート後、`points`, `creatures`, `areas` 等のIDにアンダースコア `_` が含まれていないこと。
- [ ] 新規地点登録時に生成されるIDが `p` + タイムスタンプ（例: `p173476xxxx`）の形式であること。
- [ ] 図鑑の新規提案時に生成されるIDが `propc` + タイムスタンプ、地点提案時は `propp` + タイムスタンプであること。

## 2. 階層ID（Denormalization）の検証
- [ ] Firestore 上の `points` ドキュメントに `areaId`, `zoneId`, `regionId` の3つが正しく格納されていること。
- [ ] `areas` ドキュメントに `zoneId`, `regionId` が格納されていること。
- [ ] `HierarchicalPointSelector` において、地域を選択した時に正しいエリアが表示され、エリアを選択した時に正しい地点が表示されること。（IDによる紐付け）

## 3. 地点編集・登録フローの検証
- [ ] `/add-point` 画面で地域・エリア・地区を選択し、登録した際、DBにそれらの名前だけでなくIDも記録されていること。
- [ ] `/edit-point/:id` 画面を開いた際、既存の地域情報がドロップダウンに正しく初期表示されること。
- [ ] 会員ユーザーが地点を編集し「提案」した際、`point_proposals` に正しいID規約でデータが作成されること。
- [ ] 管理者が提案を承認した際、`points` コレクションのデータが更新され、階層IDが消失していないこと。

## 4. AIパイプラインの検証
- [ ] `scripts/cleansing_pipeline.py` を実行し、`points` のフィルタリング（`--region` 等）が正常に機能すること。
- [ ] AIが生成する `point_creatures` のIDが `${pointId}_${creatureId}`（例: `p1234_c5678`）の形式で、アンダースコアが連結部分の1つのみであることを確認。

## 5. 既存機能への影響確認 (Regression)
- [ ] ダイビングログ登録画面で地点を選択できること。
- [ ] ポイント詳細ページでパンくずリストが正しく表示されること。
- [ ] 生物詳細ページの「分布データ」が正しく表示されること。
