# テストシナリオ v1.4.1

本書は、Diving Dex App バージョン1.4.1に含まれる修正および改善事項を検証するためのテストシナリオです。

## 1. 機能: 生物画像のフォールバックと著作権表示

**概要:** リンク切れ画像の修正と、著作権クレジット表示の制限（Wikipedia/CCのみ表示）を検証します。

| シナリオID | テストケース | 手順 | 期待される結果 |
| :--- | :--- | :--- | :--- |
| **IMG-01** | 画像なし/空URL | 1. `AdminCreatureCleansingPage`（管理画面）に移動する。<br>2. 画像URLが空の生物を探す。<br>3. 画像列を確認する。 | プレースホルダー画像 `no-image-creature.png` が表示されること。<br>著作権クレジットが表示されないこと。 |
| **IMG-02** | リンク切れ画像 | 1. `AdminCreatureCleansingPage` に移動する。<br>2. 生物を編集し、`imageUrl` に存在しないURL（例: `http://example.com/fail.jpg`）を設定する。<br>3. 保存してリストを確認する。<br>4. その生物の `CreatureDetailPage`（詳細画面）を開く。 | `onError` ハンドラにより、自動的に `no-image-creature.png` に切り替わって表示されること。<br>著作権クレジットが表示されないこと。 |
| **IMG-03** | 著作権クレジット（非表示） | 1. 生物の `imageUrl` に有効なURLを設定する。<br>2. `imageCredit` に "Myself"（自分）などを設定する。<br>3. `imageLicense` を空にする。<br>4. 詳細画面を確認する。 | 著作権クレジット（オーバーレイ）が表示**されない**こと。 |
| **IMG-04** | 著作権クレジット（表示 - Wiki） | 1. `imageCredit` に "Wikipedia User" を設定する。<br>2. `imageLicense` を空に設定する。<br>3. 詳細画面を確認する。 | 著作権クレジット `© Wikipedia User` が表示されること。 |
| **IMG-05** | 著作権クレジット（表示 - CC） | 1. `imageCredit` に "Test Photographer" を設定する。<br>2. `imageLicense` に "CC BY-SA 4.0" を設定する。<br>3. 詳細画面を確認する。 | 著作権クレジット `© Test Photographer (CC BY-SA 4.0)` が表示されること。 |

## 2. 機能: 利用規約モーダル

**概要:** 開発環境での再表示問題の修正と、エラーハンドリングの改善を検証します。

| シナリオID | テストケース | 手順 | 期待される結果 |
| :--- | :--- | :--- | :--- |
| **TOS-01** | 同意状態の保存確認 | 1. 新規/モックユーザー（例: `u1`）としてログインする。<br>2. モーダルが表示された場合、「同意して続ける」をクリックする。<br>3. ページをリロード（`Cmd+R`）する。 | モーダルが**再表示されない**こと。 |
| **TOS-02** | エラーハンドリング | 1. Firestore書き込みエラーをシミュレートする（例: 割り当て超過、オフライン等）。<br>2. 「同意して続ける」をクリックする。 | 画面に「エラーが発生しました」というアラートが表示されること。<br>モーダルが閉じずにそのまま残ること（誤って同意済みとならないこと）。 |
| **TOS-03** | ゲストユーザー保護 | 1. `currentUser.id` が 'guest' だが `isAuthenticated` が true になるような稀な状態（レースコンディション）を確認する。 | モーダルが表示されないこと。<br>コンソールに「No document to update」エラーが出ないこと。 |

## 3. 機能: 管理画面UX

**概要:** 保存・削除アクション時のページリロード（リダイレクト）が削除されたことを検証します。

| シナリオID | テストケース | 手順 | 期待される結果 |
| :--- | :--- | :--- | :--- |
| **ADM-01** | インライン編集保存 | 1. `AdminCreatureCleansingPage` に移動する。<br>2. 行の編集ボタンをクリックする。<br>3. 名前やレアリティを変更する。<br>4. 保存ボタンをクリックする。 | 「保存しました」のアラートが出る。<br>ページが**リロードされない**。<br>リストのデータが自動的に更新される。 |
| **ADM-02** | 個別削除 | 1. モック生物の削除ボタン（ゴミ箱アイコン）をクリックする。<br>2. 確認ダイアログでOKを押す。 | 「削除しました」のアラートが出る。<br>ページが**リロードされない**。<br>対象の行がリストから消える。 |
| **ADM-03** | 一括削除 | 1. 複数の生物にチェックを入れる。<br>2. 「Delete Selected」をクリックする。<br>3. 確認ダイアログでOKを押す。 | 「一括削除が完了しました」のアラートが出る。<br>ページが**リロードされない**。<br>対象の行が消え、選択状態が解除される。 |

## 4. 機能: コンソール警告

**概要:** Rechartsの初期描画時の警告（負の寸法）が修正されたことを検証します。

| シナリオID | テストケース | 手順 | 期待される結果 |
| :--- | :--- | :--- | :--- |
| **WARN-01** | Recharts描画確認 | 1. `CreatureDetailPage` を開く。<br>2. 開発者ツールのコンソールを開く。<br>3. ページをリロードする。 | `The width(-1) and height(-1) of chart should be greater than 0` のような警告が**表示されない**こと。 |
