# Release Notes - WeDive v6.2.2

## リリース日: 2025-12-29

## 概要
本リリースでは、ユーザーが自身の投稿したレビューを管理できる「編集・削除機能」を実装しました。Web版・モバイルアプリ版（App）の双方で、過去の投稿内容を修正、あるいは不要になった情報を削除できるようになり、情報の鮮度と正確性をユーザー自身で維持することが可能になります。

## 主な変更点

### 1. レビュー編集・削除機能のロールアウト (Web/App)
- **自己管理**: 自身が投稿したレビューに対して、編集（ペンアイコン）と削除（ゴミ箱アイコン）の操作が追加されました。
- **再承認フロー**: 承認済みのレビューを編集した場合、内容の再確認のためステータスは自動的に「承認待ち（pending）」に戻ります。
- **管理者サポート**: 管理者・モデレーターは、引き続きすべてのレビューに対して修正・不適切な単語の伏せ字化などの管理操作を行えます。

### 2. マイページ「自分の投稿（My Reviews）」タブの統合
- **一元管理**: マイページに新たに「投稿」タブを追加。自身の全投稿履歴を確認し、その場ですぐにアクションを起こせるよう導線を強化しました。
- **モバイルアプリ対応**: アプリ版でも同様の管理機能を統合し、現場での素早い修正に対応。

### 3. レビュー内容の信頼性向上
- **不要なプレースホルダーの削除**: データベース上が空の場合に表示されていた「最高でした！」という固定テキストを廃止。実際の保存内容を正確に反映するようにし、データ連携の不備を誤認させる問題を解消しました。
- **データ取得の堅牢化**: 編集画面において、コンテキストの状態に依存せず Firestore から直接最新データを取得するロジックを強化。

---

# Release Notes - WeDive v6.2.1

## リリース日: 2025-12-29

## 概要
本リリースでは、レビュー機能の安定性向上と、他ポイントとの比較による「エリア平均」の可視化を実装しました。これにより、そのポイントが周辺と比較してどれほど良好なコンディションであるかを客観的に比較・判断できるようになります。

## 主な変更点

### 1. エリア平均比較統計 (v6.2.1)
- **相対評価の導入**: ポイント詳細ページにて、同一エリア内の他ポイントの平均値をレーダーチャートと各種ゲージに重ねて表示。
- **階層型自動集計**: レビュー投稿と同時に、エリア・ゾーン・地域単位で統計データを自動更新する Cloud Functions トリガーを実装。

### 2. レビュー可視化と権限の適正化
- **マイレビュー表示**: 一般ユーザーが投稿した直後の「承認待ち」レビューが、自分の画面ですぐに確認できるようになりました。
- **閲覧権限の修正**: セキュリティルールと取得ロジックの改善により、ゲスト（未ログイン）ユーザーでも承認済みレビューが正常に閲覧可能になりました。
- **ソート順の改善**: 「最新順」の基準を、投稿日ではなく「実際に潜った日（潜水日）」に修正し、最新の海況情報を取得しやすくしました。

---

# Release Notes - WeDive v2.2.9

## リリース日: 2025-12-21

## 概要
本リリースでは、データベース設計の抜本的な見直し（IDの正規化と非正規化による高速化）を実施しました。これにより、アプリ全体のパフォーマンス向上と、将来的なデータ整合性の維持が容易になります。

## 主な変更点

### 1. データベース・スキーマの刷新
- **ID命名規則の厳格化**: 全てのID（Point, Area, Zone, Region, Creature）からアンダースコアを排除しました（例: `p_123` → `p123`）。
- **検索の最適化**: `points` コレクションに親階層のID (`regionId`, `zoneId`) を持たせることで、複数のコレクションを参照せずに高速な絞り込みが可能になりました。

### 2. UI/UXの改善
- **地点検索機能の強化**: IDベースの階層フィルタリングを実装。より確実なドリルダウン検索が可能になりました。
- **管理者ツールの改善**: 地点の編集・登録時に、地域情報をマスタから選択できるように変更。データの表記揺れを根本的に防止します。

### 3. データエンジニアリング
- **クレンジングパイプラインの高速化**: AIによる生物紐付け処理において、最適化されたスキーマを活用。
- **メンテナンススクリプトの刷新**: ID命名規則の変更に伴い、画像取得スクリプトやDBクリーンアップツールを最新のスキーマに適合させました。

---

## 開発者向け注意事項
- **破壊的変更**: 既存の `p_` 形式のIDを持つデータは、新システムでは参照できません。シードデータのIDは全て更新済みですので、環境の再構築（Hard Reset）を推奨します。
- **型定義の更新**: `src/types.ts` に階層IDが追加されています。
