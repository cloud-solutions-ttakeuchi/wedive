# アーキテクチャ決定記録 (ADR) - Web/App コード管理方針

## コンテキスト
WeDive プロジェクトは `wedive-web` (Next.js) と `wedive-app` (Expo/React Native) の2つのフロントエンドを持つ構成となっています。
開発が進むにつれ、型定義 (`types.ts`) や Firebase 接続ロジックなどの共通コードをどのように管理するかが課題となりました。

## 検討した選択肢

### プラン A: Monorepo による共通パッケージ化
- **概要**: Turborepo 等を導入し、共通ロジックを `packages/shared` に切り出す。
- **懸念点**: 
    - Web と App では関心事（ユースケース）が異なるにも関わらず、無理に共通化することで結合度が高まる。
    - 一方の変更が他方に予期せぬ影響を与える「悪いモノリス」化のリスクがある。
    - 環境構築や移行コストが高く、現在の開発スピード（Appの立ち上げ）を阻害する。

### プラン B: 独立管理（疎結合の維持）
- **概要**: ディレクトリ構成を独立させたまま維持し、必要なコードはコピーまたは個別に実装する。
- **考え方**: **「Web と App は役割の異なる別のアプリケーションである」** という前提に立つ。
    - **Web**: 管理、PCでの詳細編集、SEO、閲覧重視。
    - **App**: 現場での即時入力、GPS連携、パーソナル利用重視。
- **トレードオフ**: 型定義の同期など二重管理の手間は発生するが、それぞれのプラットフォームに最適化した実装が可能になる。

## 決定事項
**「プラン B: 独立管理」を採用する。**

### 理由
1.  **関心の分離 (Separation of Concerns)**: Web と App の役割の違いを尊重し、互いの変更に引きずられない柔軟な構成を維持するため。
2.  **開発速度**: 複雑な Monorepo 構築を行わず、App の実装（Mock からの実データ連携）を最速で進めるため。
3.  **リスク回避**: 共通化による複雑性と依存関係の増大（技術的負債）を避けるため。

## 今後の運用ルール
1.  **DBスキーマを契約とする**: Firestore のデータ構造（スキーマ）を共通の「契約」とし、これを遵守する限りにおいて、内部実装は Web/App それぞれで最適化する。
2.  **型定義の同期**: `types.ts` など共通の概念が必要な場合は、Web版をマスターとして参照しつつ、App側に必要な定義を明示的に移植（コピー）する。自動同期は行わない。
